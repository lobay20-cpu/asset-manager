{% extends "base.html" %}

{% block title %}Lista Urządzeń{% endblock %}

{% block content %}
    <hgroup>
        <h1>Lista Urządzeń</h1>
        <h2>Przeglądaj i zarządzaj sprzętem firmowym.</h2>
    </hgroup>
    
    <!-- NOWY, ZAAWANSOWANY FORMULARZ FILTROWANIA -->
    <form method="GET" action="{{ url_for('index') }}">
        <div class="grid">
            <!-- Filtr Grupy -->
            <select name="grupa_id" id="grupa_id">
                <option value="Wszystkie">Grupa: Wszystkie</option>
                {% for grupa in wszystkie_grupy %}
                    <option value="{{ grupa.id }}" {% if grupa.id == wybrana_grupa_id %}selected{% endif %}>
                        Grupa: {{ grupa.nazwa_grupy }}
                    </option>
                {% endfor %}
            </select>

            <!-- Filtr Statusu -->
            <select name="status" id="status">
                {% for status in wszystkie_statusy %}
                    <option value="{{ status }}" {% if status == wybrany_status %}selected{% endif %}>
                        Status: {{ status }}
                    </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="grid">
            <!-- Przyciski -->
            <button type="submit">Filtruj</button>
            <a href="{{ url_for('index') }}" class="secondary outline" role="button">Wyczyść filtry</a>
        </div>
    </form>

    <figure>
        <table>
            <thead>
                <tr>
                    <th>Identyfikator</th>
                    <th>Nazwa</th>
                    <th>Grupa</th>
                    <th>Aktualna Lokalizacja</th>
                    <th>Status</th>
                    <th>Akcje</th>
                </tr>
            </thead>
            <tbody>
                {% for urzadzenie in urzadzenia %}
                <tr>
                    <td><a href="{{ url_for('szczegoly_urzadzenia', urzadzenie_id=urzadzenie.id) }}">{{ urzadzenie.identyfikator_sprzetu }}</a></td>
                    <td>{{ urzadzenie.nazwa }}</td>
                    <td>{{ urzadzenie.grupa.nazwa_grupy }}</td>
                    <td>{{ urzadzenie.wyswietlana_lokalizacja }}</td>
                    <td><span class="status-tag status-{{ urzadzenie.aktualny_status.lower().replace('ę', 'e').replace(' ', '-') }}">{{ urzadzenie.aktualny_status }}</span></td>
                    <td><a href="{{ url_for('zmien_status', urzadzenie_id=urzadzenie.id) }}">Zmień</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </figure>

{% endblock %}